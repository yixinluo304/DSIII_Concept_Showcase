"0","# Rename columns to make them easier to use"
"0","names(combined_geojson) <- gsub("" "", ""_"", names(combined_geojson))"
"0","names(combined_geojson) <- gsub(""\\."", ""_"", names(combined_geojson))"
"0",""
"0","# UI"
"0","ui <- fluidPage("
"0","  titlePanel(""Interactive Map by OECD ODA Income Group""),"
"0","  sidebarLayout("
"0","    sidebarPanel("
"0","      width = 3,"
"0","      selectInput("
"0","        ""region_filter"", "
"0","        ""Select Recipient Region:"", "
"0","        choices = c(""All"", sort(unique(combined_geojson$Recipient_Region)))"
"0","      ),"
"0","      selectInput("
"0","        ""income_group_filter"", "
"0","        ""Select Income Group:"", "
"0","        choices = c(""All"", sort(unique(combined_geojson$OECD_ODA_Income_Group)))"
"0","      )"
"0","    ),"
"0","    mainPanel("
"0","      leafletOutput(""map"", height = 600)"
"0","    )"
"0","  )"
"0",")"
"0",""
"0","# Server"
"0","server <- function(input, output, session) {"
"0","  # Reactive data filtering"
"0","  filtered_data <- reactive({"
"0","    data <- combined_geojson"
"0","    if (input$region_filter != ""All"") {"
"0","      data <- data %>% filter(Recipient_Region == input$region_filter)"
"0","    }"
"0","    if (input$income_group_filter != ""All"") {"
"0","      data <- data %>% filter(OECD_ODA_Income_Group == input$income_group_filter)"
"0","    }"
"0","    validate("
"0","      need(nrow(data) > 0, ""No projects match the selected filters"")"
"0","    )"
"0","    data"
"0","  })"
"0","  "
"0","  # Render map"
"0","  output$map <- renderLeaflet({"
"0","    data <- filtered_data()"
"0","    "
"0","    # Define a color palette based on the income group"
"0","    pal <- colorFactor("
"0","      palette = ""Set1"",  # You can change the palette (e.g., Set2, Viridis)"
"0","      domain = data$OECD_ODA_Income_Group"
"0","    )"
"0","    "
"0","    leaflet(data) %>%"
"0","      addTiles() %>%"
"0","      addCircleMarkers("
"0","        lng = ~st_coordinates(geometry)[, 1],  # Longitude"
"0","        lat = ~st_coordinates(geometry)[, 2],  # Latitude"
"0","        color = ~pal(OECD_ODA_Income_Group),"
"0","        radius = 5,"
"0","        popup = ~paste0("
"0","          ""<strong>Title:</strong> "", Title, ""<br>"","
"0","          ""<strong>Funding:</strong> $"", Amount__Constant_USD_2021_ / 1e6, ""M<br>"","
"0","          ""<strong>Income Group:</strong> "", OECD_ODA_Income_Group, ""<br>"","
"0","          ""<strong>Region:</strong> "", Recipient_Region"
"0","        )"
"0","      ) %>%"
"0","      addLegend("
"0","        position = ""bottomright"","
"0","        pal = pal,"
"0","        values = ~OECD_ODA_Income_Group,"
"0","        title = ""OECD ODA Income Group"","
"0","        opacity = 1"
"0","      )"
"0","  })"
"0","}"
"0",""
"0","# Run the Shiny app"
"0","shinyApp(ui = ui, server = server)"
"2","
Listening on http://127.0.0.1:7272
"
"2","Error: Mutex failed to lock
"
